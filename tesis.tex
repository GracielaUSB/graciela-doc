\documentclass[letterpaper, 12pt, oneside, spanish]{tesis}

% Paquetes para idioma
\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Otros paquetes instalados
% Básicos
\usepackage[backend=bibtex,style=alphabetic]{biblatex}
\addbibresource{bibliografia.bib}
\usepackage{enumitem}
\usepackage{csquotes}
\usepackage{url}
\usepackage{datetime}
\usepackage{array}
\usepackage{todonotes}
\longdate

% Para dibujar figuras
\usepackage{tikz}

% Para cambiar el color de las letras
\usepackage{color}

% Para incluir código (básico)
\usepackage{verbatim}
\usepackage{fancyvrb}

% Para incluir referencias
\usepackage{hyperref}
\usepackage{nameref}
\hypersetup{urlcolor=blue, colorlinks=false}

% Para más símbolos matemáticos
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{fontspec}

% Para colocar teoremas en cajas
\usepackage{mdframed}
\usepackage{tcolorbox}

% Para texto Lorem Ipsum
\usepackage{blindtext}

% Para suprimir algunas advertencias
\usepackage{silence}

\WarningFilter{blindtext}{}     % Supress the "spanish not defined, using English instead"

% Otros paquetes
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{stackengine}
\usepackage{rotating}
\usepackage[shortcuts]{extdash}
\usepackage{relsize}
\usepackage{etoolbox}
\usepackage[justification=centering]{caption}
\usepackage{xcolor}
\usepackage{caption}

% Paquetes locales
% Puedes agregar paquetes locales (archivos .sty) en un subdirectorio % 'paquetes'.
% Utiliza la sintaxis \usepackage{paquetes/nombrePaquete}

% Todas las imágenes se cargan del subdirectorio 'img' por defecto.
\graphicspath{{img/}}

% Sangrías de 3 espacios (3 veces el espacio de la x)
\parindent 3ex

% Interlineado
\setlength{\baselineskip}{1.5pt}

% Interpárrafo
\setlength{\parskip}{16.5pt}

\topmargin 2cm

\renewcommand{\tablename}{Tabla}
\newcommand\listsymbolname{Acrónimos y Símbolos}

% item lists
\renewcommand{\labelitemi}{$\bullet$}
\renewcommand{\labelitemii}{$\textendash$}

\newcommand\getcurrentref[1]{%      \getcurrentref{chapter|section|subsection}
 \ifnumequal{\value{#1}}{0}
  {??}
  {\the\value{#1}}%
}

% compact itemize
\setlist[itemize]{nosep}

% Marco de color con título
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\newtcolorbox{coloredframe}[3][]{
    empty,
    breakable=true,
    sharp corners=all,
    top=4mm, left=4mm,
    borderline west={1.5pt}{0pt}{#3}, borderline north={1.5pt}{0pt}{#3},
    attach boxed title to top left={yshift=-1.75ex,xshift=6ex},
    coltitle=black,
    colback=white, colbacktitle=white,
    fonttitle=\bfseries,
    boxed title style={boxrule=0pt,colframe=white},
    title=#2,
    #1
}

% \newenvironment{coloredframe}[3][]{
%     \mdfsetup{
%         hidealllines=true, leftline=true,
%         frametitlerule=true, frametitlerulewidth=.25pt,
%         frametitle=#2,
%         frametitlebackgroundcolor=#3!10,
%         linewidth=1.5pt, linecolor=#3,
%         #1
%     }
%     \begin{mdframed}
% }{
%     \end{mdframed}
% }

% greens
\definecolor{caribbeangreen}{rgb}{0.0, 0.6, 0.45}

% blues
\definecolor{cerulean}{rgb}{0.0, 0.48, 0.65}
\definecolor{cyan process}{rgb}{0.0, 0.36, 0.46}

% reds
\definecolor{crimson}{rgb}{0.86, 0.08, 0.24}
\definecolor{darkcandyapplered}{rgb}{0.64, 0.0, 0.0}

\definecolor{goldensand}{rgb}{0.70,0.62,0.32}

% code and mathematics
\lstdefinelanguage{graciela}{ %
    keywordstyle=\bfseries\color{crimson},
    % list of keywords
    keywords=[1]{},
    morekeywords=[2]{
        proc, func, program, begin, end, abstract, type,
        if, do, in, out, inout, fi, od, write,
        writeln, read, from, where, of, implements,
        set, rel, relation, multiset, sequence, function,
        var, const, array, int, boolean, float, char,
        new, free, abort, warn, skip, random
    },
    keywordstyle=[2]{\color{cerulean}\bfseries},
    % symbol keywords
    alsoletter={
         +, /, \\, -, *, <, >, =, !
    },
    morekeywords=[3]{
        +,  /\\, \\/, ∧, ∨, -, *, /, div, mod, \\, ->, →, <->,
        ↔, [, ], elem, notelem, ∈, ∉, union, intersect, ∪, ∩, \Union
        msum, ⊎, ++, ⧺, subset, ssubset, superset, ssuperset,
        ⊆, ⊂, ⊊, ⊇, ⊃, ⊋, ×, ÷, ^, sqrt, √, ⇒ ⇐, ≡, ≢,
        ==>, <==, ===, !==, ==, !=, ≠, <=, <, >, >=, ≤, ≥, !, ¬,
        forall, exist, notexist, max, min, product, sum, count,
        toFloat, toInt, toChar, toBoolean, toSequence, toSet, toMultiset
        ∀, ∃, ∄, ∑, ∏, \#
    },
    keywordstyle=[3]\color{cyan process},
    morekeywords=[4]{repinv, coupinv, pre, post, bound, inv},
    keywordstyle=[4]\color{darkcandyapplered},
    morekeywords=[5]{true, false, null},
    keywordstyle=[5]\color{caribbeangreen},
    numbers=none,
    stepnumber=1,
    showstringspaces=false,
    breaklines=false,
    frame=top,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    stringstyle=\color{goldensand}\ttfamily,
    morestring=[b]',
    morestring=[b]",
    sensitive=true,                 % keywords are case-sensitive
    morestring=[b]",                % strings are in double quotes
    morestring=[d]',                % characters are in single quotes
}

\newcommand{\inlinemath}[1]{{\small\bfseries\color{cyan process}\texttt{$#1$}}}
\newcommand{\inlinecode}[1]{{\small\bfseries\color{darkcandyapplered}\texttt{#1}}}
\lstdefinestyle{code}{%
    basicstyle=\ttfamily\footnotesize,
    commentstyle={\color{gray}},        % style for comments
    captionpos=t,                       % caption position: top
    frame={l,r,t,b},                    % frame: [l]eft [r]ight [t]op [b]ottom
    frameround=ffff,                    % roundness: TR, BR, BL, TL
    framerule=0.75pt,                   % thickness of the frame
    framesep=0.5cm,                     % separation from frame to code
    rulecolor=\color{gray},
    columns=flexible,                   % flexible character width
    keepspaces=true,                    % keep all spaces
    % margins
    float,
    floatplacement=h,
    caption=NO TENGO CAPTION,
    aboveskip=1cm, xleftmargin=1cm, xrightmargin=1cm,
    % listings does not support UTF-8
    literate= {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
              {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
              {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
              {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
              {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
              {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
              {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
              {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
              {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
              {ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1
              {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
              {€}{{\EUR}}1 {£}{{\pounds}}1 {¿}{{\textquestiondown}}1
              {¡}{{\textexclamdown}}1
}

\lstset{
    style=code,
    escapechar=\~,
}

\lstnewenvironment{gracielacode}[1][]{
    \linespread{1}
    \lstset{
        language=graciela,
        style=code,
        escapechar=\~,
        #1                  % settings for the lst environment
    }
  }{
  }

\lstnewenvironment{widegracielacode}[1][]{
    \linespread{1}
    \lstset{
        language=graciela,
        style=code,
        escapechar=\~,
        xleftmargin=0cm,
        xrightmargin=0cm,
        #1                  % settings for the lst environment
    }
  }{
  }

% http://tex.stackexchange.com/q/43526
% fix the apparently deliberate but undocumented behaviour of disabling escapes other than mathescape in TextStyle (used by \lstinline)
% there may be a good reason why this is disabled by default, so beware in case it causes any problems
\makeatletter
\patchcmd{\lsthk@TextStyle}{\let\lst@DefEsc\@empty}{}{}{\errmessage{failed to patch}}
\makeatother
\newcommand{\ingra}{\lstinline[language=graciela]}

\lstnewenvironment{haskellcode}[1][]{
    \linespread{1}
    \lstset{
        language=haskell,
        keywords={          % taken from wiki.haskell.org/Keywords
            as, case, class, data, default, deriving, do, else, family, forall,
            foreign, hiding, if, import, in, infix, infixl, infixr, instance,
            let, mdo, module, newtype, of, proc, qualified, rec, then, type,
            where
        },
        keywordstyle={\color{cerulean}\bfseries},
        keywordstyle={[2]\bfseries},
        style=code,
        #1                  % settings for the lst environment
    }
}{}

\renewcommand{\lstlistingname}{Fragmento de Código}

\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}
  {\centering #1#2#3}
\captionsetup[lstlisting]{format=listing}

% Enumeración continua trans-lingual
% \let\oldmainmatter\mainmatter
% \renewcommand{\mainmatter}{%
%   \edef\temppagenumber{\arabic{page}}
%   \oldmainmatter
%   \setcounter{page}{\temppagenumber}
% }

% Macros
\newcommand{\projectTitle}{Graciela}
\newcommand{\authorName}{Moisés Ackerman Lañado \and Carlos Spaggiari Roa}
\newcommand{\tutorName}{Ernesto Hernández\nobreakdash-Novich}
\hyphenation{Araujo Jiménez Ackerman Spaggiari calloc}


\makeatletter
\let\oldchapter\chapter
\renewcommand{\chapter}{\@ifstar{\@schapterr}{\@chapterr}}
\newcommand{\@schapterr}[1]{\oldchapter*{#1}\addcontentsline{toc}{chapter}{#1}}
\newcommand{\@chapterr}[1]{\oldchapter{#1}}
\makeatother

\makeatletter
\let\oldsection\section
\renewcommand{\section}{\@ifstar{\@ssection}{\@section}}
\newcommand{\@ssection}[1]{\oldsection*{#1}\addcontentsline{toc}{section}{#1}}
\newcommand{\@section}[1]{\oldsection{#1}}
\makeatother

\makeatletter
\let\oldsubsection\subsection
\renewcommand{\subsection}{\@ifstar{\@ssubsection}{\@subsection}}
\newcommand{\@ssubsection}[1]{\oldsubsection*{#1}\addcontentsline{toc}{subsection}{#1}}
\newcommand{\@subsection}[1]{\oldsubsection{#1}}
\makeatother

\makeatletter
\let\oldsubsubsection\subsubsection
\renewcommand{\subsubsection}{\@ifstar{\@ssubsubsection}{\@subsubsection}}
\newcommand{\@ssubsubsection}[1]{\oldsubsubsection*{#1}\addcontentsline{toc}{subsubsection}{#1}}
\newcommand{\@subsubsection}[1]{\oldsubsubsection{#1}}
\makeatother


\setmonofont[
  Contextuals={Alternate},
  BoldFont={Fira Code Bold},
  ItalicFont={Fira Sans Italic},
  BoldItalicFont={Fira Sans Bold Italic}
  ]{Fira Code}
\newfontfamily{\monofallbackfont}{DejaVu Sans Mono}
\DeclareTextFontCommand{\textmonofallback}{\monofallbackfont\textscale{0.95}}
\newcommand{\qop} {\color{cyan process}{\textmonofallback{\large ★}}}
\newcommand{\op}  {\color{cyan process}{\textmonofallback{⊕ }}}
\newcommand{\Lbag}{\textmonofallback{⟅}}
\newcommand{\Rbag}{\textmonofallback{⟆}}
\newcommand{\Lseq}{\textmonofallback{⟨}}
\newcommand{\Rseq}{\textmonofallback{⟩}}
\newcommand{\Union}{\textmonofallback{∪}}
\newcommand{\Land}{\textmonofallback{∧}}
\newcommand{\Lor}{\textmonofallback{∨}}
\newcommand{\Elem}{\textmonofallback{∈}}
\newcommand{\Notelem}{\textmonofallback{∉}}
\newcommand{\Forall}{\textmonofallback{∀}}
\newcommand{\Exist}{\textmonofallback{∃}}
\newcommand{\Apost}{\textmonofallback{'}}

\newdate{presentationdate}{16}{3}{2016}


\begin{document}
\frontmatter
\begin{titlepage}
    \title{
      \vspace{-2cm} \includegraphics[width=1.2in]{./usb.png} \\[.2cm]
      \large Universidad Simón Bolívar \\
      Decanato de Estudios Profesionales \\
      Coordinación de Ingeniería de la Computación
      \vfill \LARGE \projectTitle \vfill
    }
    \author{Por: \\
      \begin{tabular}{*{2}{>{\centering}p{.40\textwidth}}}
        Moisés Ackerman Lañado & Carlos Spaggiari Roa \tabularnewline
      \end{tabular}\\[1.2cm]
      \vphantom{Realizado con la asesoría de:}\\
      \vphantom{\tutorName}\\[1.2cm]
      PROYECTO DE GRADO \\
      Presentado ante la Ilustre Universidad Simón Bolívar \\
      como requisito parcial para optar al título de \\
      Ingeniero de Computación
    }
    \date{Sartenejas, \monthname[\the\month] de \the\year}
\end{titlepage}
\maketitle
\clearpage
\begin{titlepage}
    \title{
      \vspace{-2cm} \includegraphics[width=1.2in]{./usb.png} \\[.2cm]
      \large Universidad Simón Bolívar \\
      Decanato de Estudios Profesionales \\
      Coordinación de Ingeniería de la Computación
      \vfill \LARGE \projectTitle \vfill
    }
    \author{Por: \\
      \begin{tabular}{*{2}{>{\centering}p{.40\textwidth}}}
        Moisés Ackerman Lañado & Carlos Spaggiari Roa \tabularnewline
      \end{tabular}\\[1.2cm]
      \vphantom{Realizado con la asesoría de:}\\
      \vphantom{\tutorName}\\[1.2cm]
      PROYECTO DE GRADO \\
      Presentado ante la Ilustre Universidad Simón Bolívar \\
      como requisito parcial para optar al título de \\
      Ingeniero de Computación
    }
    \date{Sartenejas, \monthname[\the\month] de \the\year}
\end{titlepage}
\maketitle

\setstretch{1.3}

% \include{./partes/portada2}

% Se incluye el acta de evaluación, verificar que se corresponda
% con el formato aceptado actualmente por el Decanato.
% \input{./partes/acta}

% El resumen debe ser de una sola página
% \addtotoc{Resumen} -- ¿Debe aparecer en el índice?

\setcounter{page}{4}
\abstract{
% \addtocontents{toc}{\vspace{1em}}


% Las palabras clave son generalmente los nombres de áreas de investigación a
% los cuales está asociado el trabajo. Generalmente son tres o cuatro.
\noindent \begin{small} \textbf{Palabras clave}: @palabra1, @palabra2, @palabra3.
\end{small}
}

% Iniciar nueva página luego del resumen
\clearpage
\setstretch{1.3}

% Agradecimientos
\acknowledgements{
}
\clearpage

\pagestyle{fancy}

% Tabla de contenidos o índice
\lhead{\emph{Índice General}}
\tableofcontents

% Estos índices solamente se usan si el libro contiene figuras, tablas y
% algoritmos. Si alguno de estos no se utiliza, comentar o eliminar las líneas
% pertinentes.
\lhead{\emph{Índice de Figuras}}
\renewcommand*\listfigurename{Índice de Figuras}
\listoffigures

\lhead{\emph{Índice de Tablas}}
\renewcommand*\listtablename{Índice de Tablas}
\listoftables

\lhead{\emph{Índice de Fragmentos de Código}}
\renewcommand{\lstlistlistingname}{Índice de Fragmentos de Código}
\lstlistoflistings

%\lhead{\emph{Índice de Algoritmos}}
%\renewcommand*\listalgorithmname{Índice de algoritmos}
%\listofalgorithms

\setstretch{1.5}
\clearpage
\lhead{\emph{Acrónimos y símbolos}}
\listofsymbols{ll}
{
    % Aquí van las siglas
    \textbf{SIGLAS} & \textbf{S}iglas \textbf{I}sla \textbf{G}rafo
                      \textbf{L}aos \textbf{A}ve \textbf{S}erpiente\\
    \textbf{ACM} & \textbf{A}ssociation for \textbf{C}omputing \textbf{M}achinery\\
    &\\
    \hline
    &\\

    % Aquí van los símbolos
    $\iff$ & doble implicación, si y sólo si\\
    $\Rightarrow$ & implicación lógica\\
    $[u:=v]$ & sustitución textual de $u$ por $v$
}

%% ----------------------------------------------------------------
% End of the pre-amble, contents and lists of things
% Begin the Dedication page

\setstretch{1.3}  % Return the line spacing back to 1.3

\pagestyle{empty}  % Page style needs to be empty for this page

\dedicatory{
    \textbf{Dedicatoria} \bigskip

    A @personasImportantes, por @razonesDedicatoria.
}

\addtocontents{toc}{\vspace{2em}}

\mainmatter
\pagestyle{fancy}

% Se incluye el cuerpo de la tesis en este documento.

\input{./partes/introduccion}

% El número de capítulos varía. En mi libro fueron cuatro (sin contar
% introducción y conclusión).
\input{./partes/capitulo1}
\input{./partes/capitulo2}
\input{./partes/capitulo3}
\input{./partes/capitulo4}

\input{./partes/conclusiones}

% El estilo de la bibliografía es AAAI, definido en el archivo aaai.bst.
\label{bibliography}
\printbibliography
\lhead{\emph{Bibliografía}}
\addtocontents{toc}{\vspace{2em}}
\addcontentsline{toc}{chapter}{Bibliografía}

% Apéndices
\appendix
\input{./partes/apendiceA}
\input{./partes/apendiceB}
\addtocontents{toc}{\vspace{2em}}

\backmatter

\end{document}
